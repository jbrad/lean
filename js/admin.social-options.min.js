/**
 * Checks to see if the recommended number of icons are active. If so, displays a warning message.
 */function checkForMaxIcons(){"use strict";jQuery("#active-icon-list").children().length>=7?jQuery("#social-icon-max").removeClass("hidden"):jQuery("#social-icon-max").addClass("hidden")}function updateActiveIcons(e){"use strict";var t="";e("#active-icons ul").children("li").each(function(){if(e(this).children().length>0&&e(this).children("img").attr("src").length>0){t+=e(this).children("img").attr("src");e(this).attr("data-url")!==undefined&&e(this).attr("data-url")!==null&&(t+="|"+e(this).attr("data-url"));t+=";"}});e("#active-social-icons").val(t)}function updateIconValues(e){"use strict";e!==undefined&&!jQuery("#active-icon-url").hasClass("hidden")&&cancelSettingIconURL(jQuery);updateActiveIcons(jQuery);updateAvailableIcons(jQuery);jQuery(this).css("border","0");jQuery.post(ajaxurl,{action:"standard_save_social_icons",nonce:jQuery("#standard-save-social-icons-nonce").text(),availableSocialIcons:jQuery("#available-social-icons").val(),activeSocialIcons:jQuery("#active-social-icons").val(),updateSocialIcons:"true"},function(t){parseInt(t,10)===0&&jQuery("#active-icon-list > li").each(function(){var t=e===undefined?!1:jQuery(e.srcElement).parents("ul").attr("id")==="active-icon-list";setupIconClickHander(jQuery,jQuery(this),t)})});checkForMaxIcons()}function cancelSettingIconURL(e){"use strict";e("#social-icon-url").siblings("input[type=text]:first").val("");e("#active-icon-url").addClass("hidden");e(".active-icon").removeClass("active-icon");updateIconValues()}function saveIconUrl(e,t){"use strict";t.preventDefault();if(e.trim(e("#social-icon-url").val()).length>0){var n=e("#social-icon-url").val();e("li.active-icon").attr("data-url",n);e("#social-icon-url").val("");e("#active-icon-url").addClass("hidden");e(".active-icon").removeClass("active-icon");updateIconValues();updateActiveIcons(e)}else{e("#active-icon-url").addClass("hidden");e(".active-icon").removeClass("active-icon")}e(".icon-url").val("")}function prepareIconMediaUploader(e){"use strict";e("#upload-social-icon").click(function(t){t.preventDefault();socialIconsShowMediaUploader(e);e("#TB_iframeContent").load(function(){var t=setInterval(function(){e("#TB_iframeContent").contents().find("#media-items").children().length>0&&socialOptionsHideUnusedFields(e,t)},500);socialOptionsHideUnusedFields(e)})})}function displayIcons(e,t,n){"use strict";var r,i,s,o,u,a;if(e("#"+t).length>0){e("#"+n+" > ul").children("li").remove();r=e("#"+t).val().split(";");e(r).each(function(){if(this.length>0){i=this.split("|");s=null;o=null;if(i.length===1)o=i[0];else{o=i[0];s=i[1]}a=e("<img />").attr("src",o);u=e("<li />").attr("data-url",s).append(a);n==="active-icons"&&setupIconClickHander(e,u);e("#"+n).children("ul").append(u)}})}}function overHandler(){"use strict";jQuery(this).css("border","1px dashed #ccc")}function makeSortable(e,t,n){"use strict";e(t).children("ul").sortable({connectWith:n+" > ul",update:updateIconValues,over:overHandler});e(n).children("ul").sortable({connectWith:t+" > ul",update:updateIconValues,over:overHandler})}function setupIconClickHander(e,t,n){"use strict";t.click(function(t){var n="";e(t.srcElement).attr("src")!==""&&e(t.srcElement).attr("src")!==undefined&&e(t.srcElement).attr("src").toString().indexOf("rss.png")>0&&(n=e("#standard-wordpress-rss-url").text());e("#active-icon-url").is(":visible")?e(this).parent().siblings("#active-icon-url").children("input[type=text]").val(""):e(this).parent().siblings("#active-icon-url").removeClass("hidden");e(this).parent().siblings("#active-icon-url").children("input[type=text]").val(e(this).attr("data-url"));e(".active-icon").removeClass("active-icon");e(this).addClass("active-icon");updateIconValues();makeSortable(e,"#active-icons","#available-icons");if(""!==n){e("#social-icon-url").val(n).attr("disabled","disabled");e("#social-rss-icon-controls").removeClass("hidden");e("#social-icon-controls").addClass("hidden")}else{e("#social-icon-url").removeAttr("disabled");e("#social-icon-controls").removeClass("hidden");e("#social-rss-icon-controls").addClass("hidden")}})}function updateAvailableIcons(e){"use strict";var t="";e("#available-icons ul").children("li").each(function(){e(this).children("img").length>0&&e(this).children("img").attr("src").length>0&&(t+=e(this).children("img").attr("src")+";")});e("#available-social-icons").val(t)}function makeIconsRemoveable(e){"use strict";e("#delete-icons").droppable({over:overHandler,drop:function(t,n){t.srcElement=t.srcElement||n.draggable.children(":first");if(isStandardIcon(e(t.srcElement)))e.post(ajaxurl,{action:"standard_delete_social_icons",nonce:e.trim(e("#standard-delete-social-icon-nonce").text())},function(t){e("#standard-delete-social-icons").length===0&&e("#message-container").append(t);e("#standard-hide-delete-social-icon-message").click(function(t){t.preventDefault();e("#standard-delete-social-icons").remove()})});else{e(t.srcElement).hide().attr("src","");e(t.srcElement).parent().hide();updateIconValues();updateAvailableIcons(e);e(this).css("border",0)}}});e("#available-icons > ul > li").click(function(){var t=e(this).children("img");e(window).keydown(function(n){n.keyCode===93&&e(window).keydown(function(n){if(n.keyCode===8){t.hide().attr("src","");updateAvailableIcons(e);e(window).unbind(n)}})})})}function socialOptionsHideUnusedFields(e,t){"use strict";var n,r,i;e("#tab-type_url",e("#TB_iframeContent")[0].contentWindow.document).hide();n=!1;r=e(".describe tbody tr, .savebutton",e("#TB_iframeContent")[0].contentWindow.document);r.each(function(){e(this).hasClass("submit")||e(this).hide()});i=e('.savesend input[type="submit"]',e("#TB_iframeContent")[0].contentWindow.document);if(i.length>0&&i!==null){i.val("Upload Social Icon");n=!0}t!==null&&n&&clearInterval(t)}function isStandardIcon(e){"use strict";return e.attr("src").toString().indexOf("/images/social/small/")>0}function socialIconsShowMediaUploader(){"use strict";tb_show("","media-upload.php?type=image&TB_iframe=true");window.restore_editor=window.send_to_editor;window.send_to_editor=function(e){var t=jQuery(e).children("img").length===1?jQuery(e).children("img"):jQuery(e);jQuery("#available-social-icons").val(jQuery("#available-social-icons").val()+";"+t.attr("src"));displayIcons(jQuery,"available-social-icons","available-icons");updateIconValues();tb_remove();window.send_to_editor=window.restore_editor}}(function(e){"use strict";e(function(){e(".social-icons-wrapper").siblings("table").hide();prepareIconMediaUploader(e);displayIcons(e,"available-social-icons","available-icons");displayIcons(e,"active-social-icons","active-icons");makeSortable(e,"#active-icons","#available-icons");makeIconsRemoveable(e);e("#set-social-icon-url").click(function(t){saveIconUrl(e,t)});e(document).keypress(function(t){if(t.keyCode===13){t.preventDefault();saveIconUrl(e,t)}});e("#cancel-social-icon-url").click(function(t){t.preventDefault();cancelSettingIconURL(e)});checkForMaxIcons();e("#reset-social-icons").click(function(t){t.preventDefault();var n=e(this);e.post(ajaxurl,{action:"standard_reset_social_icons",nonce:e.trim(e("#standard-reset-social-icons").text())},function(){n.siblings("form").submit();location.reload(!0)})})})})(jQuery);